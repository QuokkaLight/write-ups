# Ruby's count
(exp50, solved by 219)

> Description: Hi, my name is Ruby. I like converting characters into ascii values and then calculating the sum.
> 
> Service: 188.166.133.53:12037

# Solution

I can found this on the service :

> Let me count the ascii values of 10 characters:

```
<?php
error_reporting(E_ALL);

//http://homakov.blogspot.fr/2012/05/saferweb-injects-in-various-ruby.html
//http://rubular.com/

/* Get the port for the WWW service. */
$service_port = 12037;

/* Get the IP address for the target host. */
$address = '188.166.133.53';

/* Create a TCP/IP socket. */
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
if ($socket === false) {
    echo "socket_create() failed: reason: " . 
         socket_strerror(socket_last_error()) . "\n";
}

echo "Attempting to connect to '$address' on port '$service_port'...";
$result = socket_connect($socket, $address, $service_port);
if ($result === false) {
    echo "socket_connect() failed.\nReason: ($result) " . 
          socket_strerror(socket_last_error($socket)) . "\n";
}

$msg = 'ffffffffff';
$out = '';

echo "Reading response:\n\n";
$i = 0;
while ($out = socket_read($socket, 2048)) {
    echo $out;
    if ($i%2 == 1) {
    	$result = explode(" ", $out);
    	socket_write($socket, $msg, strlen($msg));
    }
    $i++;
}

socket_close($socket);

?>
```

Then i receive the message :

> That's not enough (1020 < 1020) :(

Then i read this article http://homakov.blogspot.fr/2012/05/saferweb-injects-in-various-ruby.html and change the message to :

```
$msg = 'a
ffffffffff';
```

Then i get the flag : **IW{RUBY_R3G3X_F41L}**